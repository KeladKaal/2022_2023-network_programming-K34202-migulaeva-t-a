University: ITMO University

Faculty: FICT

Course: Network programming

Year: 2022

Group: K34202

Author: Migulaeva Tatyana Alekseevna

Lab: Lab2

Date of create: 26.09.2022

Date of finished: 

Тема работы: Развертывание дополнительного CHR, первый сценарий Ansible

Цель работы: С помощью Ansible настроить несколько сетевых устройств и собрать информацию о них. Правильно собрать файл Inventory.

Ход работы:
1. Начинаем работу с Ansible. Для этого создаём файл hosts.ini, в котором указываем конфигурацию нашего RouterOS. В данном случае это его IP, логин и пароль.
2. Создаём первый playbook, в котором указываем команду вывода информации о системе в консоль. Это нужно для проверки того, что ansible работает.
3. Поскольку в данном способе решения лабораторных работ используется WireGuard, то нужно для начала запустить подключение со стороны клиента. Понятно, что в реальных системах этот способ не очень удобен, в крайнем случае можно попробовать автоматизировать эту настройку, чтобы клиент автоматически через одинаковые промежутки времени отправлял пинг в сторону сервера. Но на данный момент это делается вручную.
4. После этого на удалённой машине запускаем команду ansible-playbook playbook.yml -i ./hosts.ini
5. В выводе есть информация о нашем виртуальном роутере, следовательно, всё работает корректно.

![image](https://user-images.githubusercontent.com/64036217/192965989-a781334f-7a23-4d17-b02e-1eedb3cc502f.png)
7. Создаём виртуальную машину Mikro2. Проделываем все описанные в первой лаборатоной пункты, в итоге обе машины настроены как Wireguard клиенты, в моём случае первая машина - 192.168.6.67, вторая - 192.168.6.68. 
![image](https://user-images.githubusercontent.com/64036217/192967415-0b1115a5-0f56-4427-8d20-60446e384b9f.png)
8. Далее прописываем все необходимые по задаче команды. Это создание нового пользователя с логином и паролем, изменение указанного времени и настройка OSPF сети. 
![image](https://user-images.githubusercontent.com/64036217/192969613-286101d5-f964-4d9b-b6b3-72310bd3ae9f.png)

9. Запускаем ansible, смотрим на вывод результатов команды. В моём случае все указанные команды уже были выполнены аналогичным способом ранее, поэтому вывод состоит в основном из "already exists". 
![image](https://user-images.githubusercontent.com/64036217/192970598-d4ccc4a9-6479-47e7-9ed1-885aeea9618f.png)

10. Проверим, что всё действительно было создано. В первую очередь, пользователи.
![image](https://user-images.githubusercontent.com/64036217/192971025-3a566f71-5bb1-4a51-a8af-31af05d84735.png)

11. Проверим установленное время. Информация о его изменении сама автоматически высветилась в консоли.
![image](https://user-images.githubusercontent.com/64036217/192971579-8d98bbdc-ceb2-4e60-b9c9-e9946bd8135b.png)

12. И, наконец, проверим OSPF. В случае корректной работоспособности роутеры будут видеть друг друга как Neighbors.
![image](https://user-images.githubusercontent.com/64036217/192972263-b5594b70-d124-4226-a79a-0ec163122f5c.png)

13. Теперь необходимо собрать полный конфиг устройства со всеми настройками. Сдлеать это удобно через команду export. Сохраняем файл на хосте. Можно также сохранить только часть конфига - в нашем случае это OSPF.
![image](https://user-images.githubusercontent.com/64036217/192973839-894e6b90-d1e5-4748-a03a-2cc660bf3470.png)

14. Посмотрим, как выглядит всё, что было создано, на диаграмме.
![image](https://user-images.githubusercontent.com/64036217/192977763-9d1d698f-e52c-4dce-acf5-549ba4af67b5.png)

Выводы: Ansible удобен для удалённой работы сразу с несколькими роутерами, в случае если им необхожимо настроить одинаковые конфигурации.


